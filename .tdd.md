# TDD Implementation Plan - Union Strategy Game

## Project Overview
- Theme: UNION
- Strategy game to build nation alliances
- Technology: Go + Ebitengine + Bamenn
- Screen size: 640x360 (game internal), 1280x720 (display)

## Feature List

### Phase 1: Basic Game Structure ✅
- [x] **F1.1**: Game initialization with Ebitengine
- [x] **F1.2**: Screen layout system (640x360 internal resolution)
- [x] **F1.3**: Scene management system
- [x] **F1.4**: Basic input handling

### Phase 2: Scene System Implementation
- [ ] **F2.1**: Title scene with story introduction
- [ ] **F2.2**: InGame scene with 5 UI components layout
- [ ] **F2.3**: Result scene for game completion
- [ ] **F2.4**: Scene transition system

### Phase 3: InGame UI Components
- [ ] **F3.1**: ResourceView component (gold, iron, wood, grain, mana)
- [ ] **F3.2**: Calendar component (starting from Kingdom Year 1000, Month 4)
- [ ] **F3.3**: History component for battle logs
- [ ] **F3.4**: CardDeck component for player cards
- [ ] **F3.5**: GameMain component container

### Phase 4: GameMain Screens
- [ ] **F4.1**: Map screen with 13x7 grid points
- [ ] **F4.2**: Point types (Home, Wild, NPC Nation, Boss)
- [ ] **F4.3**: Point connectivity and pathfinding
- [ ] **F4.4**: Diplomacy screen for NPC interactions
- [ ] **F4.5**: Battle screen for combat

### Phase 5: Game Logic
- [ ] **F5.1**: Resource management system
- [ ] **F5.2**: Turn-based system (1 turn = 1 month)
- [ ] **F5.3**: Card system (Unit, Enchant, Building types)
- [ ] **F5.4**: Territory control system
- [ ] **F5.5**: Alliance system with NPCs

### Phase 6: Combat System
- [ ] **F6.1**: Card placement system (front/back rows, max 5 each)
- [ ] **F6.2**: Basic combat resolution
- [ ] **F6.3**: Victory/defeat conditions

## Test List

### Phase 1 Tests ✅
- [x] **T1.1**: Test game initializes without errors
- [x] **T1.2**: Test screen resolution is correctly set
- [x] **T1.3**: Test scene manager can switch between scenes
- [x] **T1.4**: Test basic keyboard/mouse input detection

### Phase 2 Tests
- [ ] **T2.1**: Test title scene displays correctly
- [ ] **T2.2**: Test InGame scene UI layout (5 components in correct positions)
- [ ] **T2.3**: Test result scene displays game history
- [ ] **T2.4**: Test scene transitions work properly

### Phase 3 Tests
- [ ] **T3.1**: Test ResourceView displays all 5 resource types
- [ ] **T3.2**: Test Calendar shows correct year/month format
- [ ] **T3.3**: Test History component can add and display entries
- [ ] **T3.4**: Test CardDeck can display multiple cards horizontally
- [ ] **T3.5**: Test GameMain container switches between sub-screens

### Phase 4 Tests
- [ ] **T4.1**: Test Map screen generates 13x7 grid correctly
- [ ] **T4.2**: Test point types are assigned correctly (1 home, 1 boss, multiple wild/NPC)
- [ ] **T4.3**: Test point connectivity rules (can't access blocked paths)
- [ ] **T4.4**: Test Diplomacy screen shows available cards for purchase
- [ ] **T4.5**: Test Battle screen allows card placement

### Phase 5 Tests
- [ ] **T5.1**: Test resource values update correctly
- [ ] **T5.2**: Test turn counter increments monthly
- [ ] **T5.3**: Test card types have correct properties
- [ ] **T5.4**: Test territory control affects resource generation
- [ ] **T5.5**: Test alliance formation with NPCs

### Phase 6 Tests
- [ ] **T6.1**: Test cards can be placed in front/back rows (max 10 total)
- [ ] **T6.2**: Test combat calculates damage correctly
- [ ] **T6.3**: Test victory conditions trigger properly

## Implementation Notes

### Directory Structure
```
/
├── main.go
├── game/
│   ├── game.go
│   ├── scene/
│   │   ├── title.go
│   │   ├── ingame.go
│   │   └── result.go
│   ├── component/
│   │   ├── resource_view.go
│   │   ├── calendar.go
│   │   ├── history.go
│   │   ├── card_deck.go
│   │   └── game_main.go
│   ├── entity/
│   │   ├── card.go
│   │   ├── point.go
│   │   └── resource.go
│   └── system/
│       ├── resource_manager.go
│       ├── turn_manager.go
│       └── combat_manager.go
├── assets/
│   ├── images/
│   └── fonts/
└── test/
    └── *_test.go
```

### Component Layout (InGame Scene)
- GameMain: {0,20,520,280}
- ResourceView: {0,0,520,20}
- Calendar: {520,0,120,40}
- History: {520,80,120,320}
- CardDeck: {0,300,520,60}

### Development Cycle
1. Pick next unchecked feature from Feature List
2. Write corresponding test(s) from Test List
3. Run test (RED) - should fail
4. Implement minimal code to pass test (GREEN)
5. Refactor code while keeping test green (REFACTOR)
6. Mark feature and test as completed
7. Repeat

## Current Sprint: Phase 2
**Goal**: Implement scene system with proper transitions and UI layouts

**Completed in Phase 1**:
- ✅ Ebitengine game initialization
- ✅ Screen layout system (640x360)
- ✅ Scene management system
- ✅ Basic input handling

**Next Actions**:
1. Implement scene transition system
2. Create proper InGame scene with 5 UI components layout
3. Add Result scene for game completion
4. Test scene transitions work properly
